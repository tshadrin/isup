{% if app.session.get('hide_block_today_orders') is defined and app.session.get('hide_block_today_orders') == true %}
    {% set hbto = true %}
{% endif %}
{% if app.session.get('hide_block_previlous_orders') is defined and app.session.get('hide_block_previlous_orders') == true %}
    {% set hbpo = true %}
{% endif %}
    <table class="table table-sm orders-table generic-table">
        <caption class="pt-0 pb-0">{{ title }}:{{  orders|length }}
            <div id="{{ hide_name }}" class="show-hide-button">
                {% if (hbto is defined and hide_name == 'today_orders') or
                    (hbpo is defined and hide_name == 'previlous_orders') %}
                    <i class="fa fa-plus" aria-hidden="true"></i>
                {% else %}
                    <i class="fa fa-minus" aria-hidden="true"></i>
                {% endif %}
            </div>
        </caption>
        {% if (hbto is defined and hide_name == 'today_orders') or
              (hbpo is defined and hide_name == 'previlous_orders') %}
            <thead style="display:none;">
        {% else %}
            <thead>
        {% endif %}
        <tr>
            <th>№</th>
            <th>Id</th>
            <th>Данные клиента</th>
            <th>Комментарий</th>
            <th>Добавил</th>
            <th>Выполняет</th>
            <th>Статус</th>
            <th>Действия</th>
        </tr>
        </thead>
        {% if (hbto is defined and hide_name == 'today_orders') or
            (hbpo is defined and hide_name == 'previlous_orders') %}
            <tbody style="display:none;">
        {% else %}
            <tbody>
        {% endif %}
        {% for num, order in orders %}
            <tr{% if loop.index0 is even %} class="chet"{% endif %}>
                <td>
                    <a class="content-link" target="_blank" href="{{ path('order_print', {'id': order.id}) }}">
                        {{ order.id }}
                    </a>
                </td>
                <td>
                    {% if order.utmid is not empty %}
                    <a class="content-link" href="{{ path('search', {'type':'id', 'value': order.utmid}) }}">
                        {{ order.utmid }}
                    </a>
                    {% endif %}
                </td>
                <td>
                    <div class="row m-0 p-0">
                        <div class="col-lg-12 col-xl-12 m-0 pl-1">
                            <span class="font-weight-bold">ФИО:</span> {{ order.fullname }}
                        </div>
                        <div class="col-lg-12 col-xl-12 m-0 pl-1 pt-1">
                            <span class="font-weight-bold">Адрес:</span> {{ order.address }}
                        </div>
                        <div class="col-lg-12 col-xl-12 m-0 pl-1 pt-1">
                            <span class="font-weight-bold">Телефон:</span>{{ order.phone }}
                        </div>
                        <div class="col-lg-12 col-xl-12 m-0 pl-1 pt-1">
                            <span class="font-weight-bold">Сервер:</span> {{ order.servername is not empty?order.servername}}
                        </div>
                        <div class="col-lg-12 col-xl-12 m-0 pl-1 pt-1">
                            <span class="font-weight-bold">IP:</span> {{ order.ipaddress }}
                        </div>
                    </div>
                </td>
                <td>
                    <div class="row m-0 p-0">
                        <div class="col-12 m-0 p-0">
                            <div class="x-editable"
                                  data-mode="inline"
                                  data-inputclass="form-control form-control-lg w-100"
                                  data-type="textarea"
                                  data-emptytext="комментарий не задан"
                                  data-value="{{ order.comment }}"
                                  data-pk="{{ order.id }}"
                                  data-rows="0"
                                  data-name="comment"
                                  data-url="{{ path('order_change_editable_field') }}"
                            ></div>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="row p-0 m-0">
                        <div class="col-12 m-0 p-1">{{ order.user.fullname }}</div>
                        <div class="col-12 m-0 p-1">{{ order.created|date('d-m-Y H:i') }}</div>
                    </div>
                </td>
                <td id="td-{{ order.id }}">
                    <div class="row m-0 p-0">
                        <div class="col-12 m-0 p-0">
                            <div class="x-editable"
                                 data-mode="inline"
                                 data-type="select"
                                 data-emptytext="Не назначена"
                                 data-value="{{ order.executed is not null ? order.executed.id : '' }}"
                                 data-pk="{{ order.id }}"
                                 data-name="executed"
                                 data-source="{{ path('order_get_employees') }}"
                                 data-url="{{ path('order_change_editable_field') }}"
                            ></div>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="row m-0 p-0">
                        <div class="col-12 m-0 p-0">
                            <div class="x-editable"
                                  data-mode="inline"
                                  data-type="select"
                                  data-value="{{ order.status.id }}"
                                  data-pk="{{ order.id }}"
                                  data-name="status"
                                  data-source="{{ path('order_get_statuses') }}"
                                  data-url="{{ path('order_change_editable_field') }}"
                            ></div>
                        </div>
                    </div>
                </td>
                <td>
                    <div class="edit-button-link m-0 pt-1 pb-1 text-nowrap">
                        <a href="{{ path('order_print', {'id': order.id}) }}">
                            <i class="fa fa-print" aria-hidden="true"></i>
                            Печать
                        </a>
                    </div>
                    {% if is_granted('ROLE_ORDER_MODERATOR') %}
                        <div class="edit-button-link m-0 pt-1 text-nowrap">
                            <a data-toggle="confirmation" href="{{ path('order_delete', {'id': order.id}) }}">
                                <i class="fa fa-trash" aria-hidden="true"></i>
                                Удалить
                            </a>
                        </div>
                    {% endif %}
                </td>
            </tr>
            {% if order.emptyPassport %}
            <tr><td colspan="8" style="background:#ffdad8;">{{ 'Need to update client passport data'|trans }}</td></tr>
            {% endif %}
        {% endfor %}
        </tbody>
    </table>
